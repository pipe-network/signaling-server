package values

import (
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestNonceFromBytes(t *testing.T) {
	nonceBytes := [24]byte{
		0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, // Cookie
		0x10,       // Source
		0x11,       // Destination
		0x12, 0x13, // OverflowNumber
		0x14, 0x15, 0x16, 0x17, // SequenceNumber
	}

	nonce := NonceFromBytes(nonceBytes)
	assert.Equal(t,
		Nonce{
			Cookie: Cookie{
				0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
			},
			Source:         16,
			Destination:    17,
			OverflowNumber: OverflowNumber{0x12, 0x13},
			SequenceNumber: SequenceNumber{0x14, 0x15, 0x16, 0x17},
		},
		nonce,
	)
}

func TestNonce_Bytes(t *testing.T) {
	nonce := Nonce{
		Cookie: Cookie{
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
		},
		Source:         16,
		Destination:    17,
		OverflowNumber: OverflowNumber{0x12, 0x13},
		SequenceNumber: SequenceNumber{0x14, 0x15, 0x16, 0x17},
	}

	assert.Equal(t,
		[24]byte{
			0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, // Cookie
			0x10,       // Source
			0x11,       // Destination
			0x12, 0x13, // OverflowNumber
			0x14, 0x15, 0x16, 0x17, // SequenceNumber
		},
		nonce.Bytes(),
	)
}
